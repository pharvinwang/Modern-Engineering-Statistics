# W5_engineering_distributions.py

import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import poisson, expon, gamma, weibull_min, norm

st.set_page_config(layout="wide")
st.title("ç¬¬ 5 é€±ï½œå·¥ç¨‹ä¸­çš„æ©Ÿç‡åˆ†é…é¸æ“‡")
st.caption("ğŸ“˜ æ•™ç§‘æ›¸ç¬¬ 5 ç« ï¼ˆ5.1â€“5.6ï¼‰")

st.markdown("""
å·¥ç¨‹ä¸­å¸¸è¦‹çš„ç¶“é©—å…¬å¼ã€è¨­è¨ˆå€¼ã€å›æ­¸ä¿‚æ•¸ï¼Œ  
èƒŒå¾Œå¹¾ä¹éƒ½éš±å«äº†ä¸€å€‹ **æ©Ÿç‡åˆ†é…å‡è¨­**ã€‚
""")

# =================================================
# A. å·¥ç¨‹å•é¡Œé¸æ“‡
# =================================================
st.subheader("ä¸€ã€å·¥ç¨‹å•é¡Œï¼ˆå…ˆé¸å•é¡Œï¼Œä¸é¸åˆ†é…ï¼‰")

problem = st.selectbox(
    "é¸æ“‡å·¥ç¨‹æƒ…å¢ƒ",
    [
        "é‡æ¸¬èª¤å·® / ææ–™æ€§è³ª",
        "ä¸€å®šæ™‚é–“å…§äº‹ä»¶æ¬¡æ•¸",
        "å…ƒä»¶å¤±æ•ˆç­‰å¾…æ™‚é–“",
        "ç´¯ç©é›¨é‡æˆ–å£½å‘½",
        "æœ‰é™æ¯é«”çš„æ–½å·¥æŠ½é©—"
    ]
)

# =================================================
# B. ä¾å·¥ç¨‹å•é¡Œè¨­å®šåˆ†é…
# =================================================
x = np.linspace(0, 200, 1000)

if problem == "é‡æ¸¬èª¤å·® / ææ–™æ€§è³ª":
    st.markdown("ğŸ“Œ å¸¸æ…‹åˆ†é…ï¼ˆNormalï¼‰")
    mu = st.slider("å¹³å‡å€¼ Î¼", 0.0, 200.0, 100.0)
    sigma = st.slider("æ¨™æº–å·® Ïƒ", 1.0, 50.0, 15.0)
    y = norm.pdf(x, mu, sigma)
    explanation = "é©ç”¨æ–¼å¤§é‡å°èª¤å·®ç–ŠåŠ çš„å·¥ç¨‹é‡"

elif problem == "ä¸€å®šæ™‚é–“å…§äº‹ä»¶æ¬¡æ•¸":
    st.markdown("ğŸ“Œ åœç“¦æ¾åˆ†é…ï¼ˆPoissonï¼‰")
    lam = st.slider("å¹³å‡äº‹ä»¶æ•¸ Î»", 0.1, 20.0, 5.0)
    x = np.arange(0, 30)
    y = poisson.pmf(x, lam)
    explanation = "é©ç”¨æ–¼ç¨ç«‹ã€éš¨æ©Ÿç™¼ç”Ÿçš„å·¥ç¨‹äº‹ä»¶"

elif problem == "å…ƒä»¶å¤±æ•ˆç­‰å¾…æ™‚é–“":
    st.markdown("ğŸ“Œ æŒ‡æ•¸åˆ†é…ï¼ˆExponentialï¼‰")
    lam = st.slider("å¤±æ•ˆç‡ Î»", 0.01, 1.0, 0.1)
    y = expon.pdf(x, scale=1/lam)
    explanation = "å‡è¨­å¤±æ•ˆèˆ‡ä½¿ç”¨æ™‚é–“ç„¡é—œ"

elif problem == "ç´¯ç©é›¨é‡æˆ–å£½å‘½":
    st.markdown("ğŸ“Œ ä¼½ç‘ª / Weibull åˆ†é…")
    shape = st.slider("å½¢ç‹€åƒæ•¸", 0.5, 5.0, 2.0)
    scale = st.slider("å°ºåº¦åƒæ•¸", 1.0, 50.0, 10.0)
    y = weibull_min.pdf(x, shape, scale=scale)
    explanation = "é©ç”¨æ–¼è€åŒ–ã€ç–²å‹ã€ç´¯ç©æ•ˆæ‡‰"

else:
    st.markdown("ğŸ“Œ è¶…å¹¾ä½•åˆ†é…ï¼ˆæ¦‚å¿µï¼‰")
    st.info("æœ‰é™æ¯é«”æŠ½æ¨£ï¼Œå¾ŒçºŒç« ç¯€æœƒè©³ç´°è™•ç†")
    y = None
    explanation = "æ–½å·¥å“è³ªæŠ½é©—ï¼Œæ¯é«”æœ‰é™"

# =================================================
# C. è¦–è¦ºåŒ–
# =================================================
st.subheader("äºŒã€åˆ†é…å½¢ç‹€èˆ‡å·¥ç¨‹æ„ç¾©")

fig, ax = plt.subplots()
if y is not None:
    ax.plot(x, y)
    ax.set_ylabel("æ©Ÿç‡å¯†åº¦ / æ©Ÿç‡")
    ax.set_xlabel("å·¥ç¨‹é‡")
st.pyplot(fig, use_container_width=True)

# =================================================
# D. å·¥ç¨‹è§£è®€
# =================================================
st.subheader("ä¸‰ã€å·¥ç¨‹è§£è®€")

st.warning(f"""
ğŸ” å·¥ç¨‹è§£é‡‹ï¼š
{explanation}

æ€è€ƒï¼š
- å¦‚æœä½ éŒ¯ç”¨å¸¸æ…‹åˆ†é…ï¼Œå°¾ç«¯é¢¨éšªæœƒè¢«ä½ä¼°å—ï¼Ÿ
- å“ªäº›å·¥ç¨‹å•é¡Œã€Œä¸èƒ½ã€ç”¨å¸¸æ…‹åˆ†é…ï¼Ÿ
""")

st.info("""
ğŸ“Œ æœ¬é€±é‡é»ï¼š
- åˆ†é…æ˜¯æè¿°å·¥ç¨‹ç¾è±¡çš„å·¥å…·
- é¸éŒ¯åˆ†é…ï¼Œå·¥ç¨‹é¢¨éšªæœƒè¢«èª¤åˆ¤

å¾ŒçºŒç« ç¯€å°‡æ•™ä½ ï¼š
- å¦‚ä½•ç”¨è³‡æ–™åˆ¤æ–·åˆ†é…æ˜¯å¦åˆç†
""")
