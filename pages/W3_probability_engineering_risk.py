# W3_Probability.py
# ç¬¬ 3 é€±ï½œæ©Ÿç‡èˆ‡å·¥ç¨‹æ¡ˆä¾‹äº’å‹•é ï¼ˆä¿®æ­£ç‰ˆï¼‰

import streamlit as st
import numpy as np
import pandas as pd

st.set_page_config(layout="wide")
st.title("ç¬¬ 3 é€±ï½œæ©Ÿç‡èˆ‡å·¥ç¨‹æ¡ˆä¾‹")
st.caption("ğŸ“˜ æ•™ç§‘æ›¸ç¬¬ 3 ç« ï½œçµ±è¨ˆåŸºæœ¬æ¦‚å¿µèˆ‡æ©Ÿç‡æ‡‰ç”¨")

# =================================================
# èª²ç¨‹èªªæ˜
# =================================================
st.markdown("""
æœ¬é€±é‡é»ï¼š
- çµ±è¨ˆåŸºæœ¬æ¦‚å¿µ
- æ©Ÿç‡è¨ˆç®—
- æ¢ä»¶æ©Ÿç‡èˆ‡å·¥ç¨‹æ‡‰ç”¨
""")

# =================================================
# å·¥ç¨‹æ¡ˆä¾‹é¸æ“‡
# =================================================
st.subheader("ä¸€ã€å·¥ç¨‹æ¡ˆä¾‹é¸æ“‡")
case = st.selectbox(
    "é¸æ“‡æ¡ˆä¾‹",
    ["å¡åœ°é™é›¨äº‹ä»¶", "æ–½å·¥ç¼ºé™·äº‹ä»¶"]
)

np.random.seed(42)

# =================================================
# è³‡æ–™ç”Ÿæˆ
# =================================================
if case == "å¡åœ°é™é›¨äº‹ä»¶":
    st.markdown("å¡åœ°é™é›¨äº‹ä»¶ï¼ˆ1=é™é›¨, 0=ç„¡é›¨ï¼‰")
    events = np.random.binomial(1, 0.3, 20)
    unit = "äº‹ä»¶"
else:
    st.markdown("æ–½å·¥ç¼ºé™·äº‹ä»¶ï¼ˆ1=ç¼ºé™·, 0=è‰¯å“ï¼‰")
    events = np.random.binomial(1, 0.1, 20)
    unit = "äº‹ä»¶"

st.write(pd.DataFrame({"SampleID": np.arange(1,len(events)+1), "Value": events}))

# =================================================
# æ©Ÿç‡è¨ˆç®—
# =================================================
st.subheader("äºŒã€æ©Ÿç‡è¨ˆç®—")
prob_event = np.mean(events)
st.write(f"äº‹ä»¶ç™¼ç”Ÿæ©Ÿç‡ä¼°è¨ˆ P(event) = {prob_event:.2f}")

# =================================================
# æ¢ä»¶æ©Ÿç‡äº’å‹•
# =================================================
st.subheader("ä¸‰ã€æ¢ä»¶æ©Ÿç‡äº’å‹•")
st.markdown("""
å‡è¨­å·¥ç¨‹å ´åœ° A èˆ‡ Bï¼Œæ¯å€‹å ´åœ°çš„äº‹ä»¶ç™¼ç”Ÿæ©Ÿç‡ä¸åŒã€‚
å¯ä»¥æ‰‹å‹•è¼¸å…¥å„å ´åœ°äº‹ä»¶æ•¸é‡ï¼Œè¨ˆç®—æ¢ä»¶æ©Ÿç‡ã€‚
""")

col1, col2 = st.columns(2)
with col1:
    event_A = st.number_input("å ´åœ° A äº‹ä»¶æ•¸", min_value=0, max_value=20, value=6)
    total_A = st.number_input("å ´åœ° A æ¨£æœ¬ç¸½æ•¸", min_value=1, max_value=20, value=10)
with col2:
    event_B = st.number_input("å ´åœ° B äº‹ä»¶æ•¸", min_value=0, max_value=20, value=3)
    total_B = st.number_input("å ´åœ° B æ¨£æœ¬ç¸½æ•¸", min_value=1, max_value=20, value=10)

P_A = event_A/total_A
P_B = event_B/total_B
P_B_given_A = P_B  # ç°¡å–®ç¤ºç¯„æ¢ä»¶æ©Ÿç‡æ¦‚å¿µï¼Œå¯å»¶ä¼¸

st.write(f"P(äº‹ä»¶ | å ´åœ° A) = {P_A:.2f}")
st.write(f"P(äº‹ä»¶ | å ´åœ° B) = {P_B:.2f}")
st.write(f"æ¢ä»¶æ©Ÿç‡ç¤ºç¯„ P(B|A) â‰ˆ {P_B_given_A:.2f}")

# =================================================
# å·¥ç¨‹åæ€
# =================================================
st.subheader("å››ã€å·¥ç¨‹åæ€")
st.markdown("""
1. é™é›¨æˆ–æ–½å·¥ç¼ºé™·äº‹ä»¶çš„æ©Ÿç‡å¦‚ä½•å½±éŸ¿å·¥ç¨‹æ±ºç­–ï¼Ÿ
2. å¦‚ä½•ä½¿ç”¨æ¢ä»¶æ©Ÿç‡è©•ä¼°ä¸åŒå ´åœ°é¢¨éšªï¼Ÿ
3. ä½ å¯ä»¥ç”¨æœ¬é€±æ¦‚å¿µè¨­è¨ˆç°¡å–®çš„é¢¨éšªè©•ä¼°è¡¨ã€‚
""")
