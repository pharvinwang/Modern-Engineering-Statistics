# W4_random_variable_and_system.py

import streamlit as st
import numpy as np
import matplotlib.pyplot as plt

st.set_page_config(layout="wide")
st.title("ç¬¬ 4 é€±ï½œéš¨æ©Ÿè®Šæ•¸ã€æ©Ÿç‡åˆ†é…èˆ‡å·¥ç¨‹ç³»çµ±")
st.caption("ğŸ“˜ æ•™ç§‘æ›¸ç¬¬ 4 ç« ï¼ˆ4.1â€“4.3ï¼‰ï¼‹ç¬¬ 3 ç«  3.5")

st.markdown("""
å·¥ç¨‹çµ±è¨ˆçš„ç¬¬ä¸€å€‹é—œéµè½‰æ›ï¼š

ğŸ‘‰ å·¥ç¨‹é‡ä¸æ˜¯å›ºå®šå€¼ï¼Œè€Œæ˜¯ **éš¨æ©Ÿè®Šæ•¸**  
ğŸ‘‰ å·¥ç¨‹å®‰å…¨ä¸æ˜¯å–®é»ï¼Œè€Œæ˜¯ **ç³»çµ±çµæœ**
""")

# =================================================
# æ¨¡çµ„ Aï¼šéš¨æ©Ÿè®Šæ•¸èˆ‡å·¥ç¨‹åˆ†é…
# =================================================
st.subheader("ä¸€ã€å·¥ç¨‹é‡ä½œç‚ºéš¨æ©Ÿè®Šæ•¸")

case = st.selectbox(
    "é¸æ“‡å·¥ç¨‹é‡",
    ["å¡åœ°ä½ç§»", "å–®å ´é™é›¨é‡", "ææ–™å¼·åº¦"]
)

mean = st.slider("å¹³å‡å€¼ï¼ˆæœŸæœ›å€¼ï¼‰", 0.0, 200.0, 50.0)
std = st.slider("è®Šç•°ç¨‹åº¦ï¼ˆæ¨™æº–å·®ï¼‰", 1.0, 50.0, 10.0)

samples = np.random.normal(mean, std, 1000)

fig, ax = plt.subplots()
ax.hist(samples, bins=30, edgecolor="black")
ax.set_title("å·¥ç¨‹é‡çš„åˆ†é…å½¢ç‹€")
st.pyplot(fig, use_container_width=True)

st.info(f"""
ğŸ” è§£è®€ï¼š
- å¹³å‡å€¼ = {mean}
- æ¨™æº–å·® = {std}

å³ä½¿å¹³å‡å€¼ä¸è®Šï¼Œåªè¦è®Šç•°è®Šå¤§ï¼Œ
å·¥ç¨‹é¢¨éšªå°±æœƒæ”¹è®Šã€‚
""")

# =================================================
# æ¨¡çµ„ Bï¼šå·¥ç¨‹ç³»çµ±å¯é åº¦
# =================================================
st.subheader("äºŒã€å·¥ç¨‹ç³»çµ±å¯é åº¦ï¼ˆè¤‡åˆäº‹ä»¶ï¼‰")

st.markdown("""
å‡è¨­ä¸€å€‹å·¥ç¨‹ç³»çµ±åŒ…å«ä¸‰å€‹å…ƒä»¶ï¼ˆå¦‚æ’æ°´ã€é‚Šå¡ã€æ”¯æ’ï¼‰ï¼š
""")

col1, col2, col3 = st.columns(3)

with col1:
    p1 = st.slider("å…ƒä»¶ A å¤±æ•ˆæ©Ÿç‡", 0.0, 1.0, 0.2)
with col2:
    p2 = st.slider("å…ƒä»¶ B å¤±æ•ˆæ©Ÿç‡", 0.0, 1.0, 0.2)
with col3:
    p3 = st.slider("å…ƒä»¶ C å¤±æ•ˆæ©Ÿç‡", 0.0, 1.0, 0.2)

system_type = st.radio(
    "ç³»çµ±å‹å¼",
    ["ä¸²è¯ç³»çµ±ï¼ˆä»»ä¸€å¤±æ•ˆå³å‡ºäº‹ï¼‰", "ä¸¦è¯ç³»çµ±ï¼ˆå…¨éƒ¨å¤±æ•ˆæ‰å‡ºäº‹ï¼‰"]
)

if system_type.startswith("ä¸²è¯"):
    system_failure = 1 - (1 - p1) * (1 - p2) * (1 - p3)
else:
    system_failure = p1 * p2 * p3

st.metric("ç³»çµ±å¤±æ•ˆæ©Ÿç‡", f"{system_failure:.2%}")

st.warning("""
ğŸ“Œ å·¥ç¨‹å•Ÿç¤ºï¼š
- å¤šä¸€é“é˜²ç·šï¼Œé¢¨éšªä¸ä¸€å®šç·šæ€§ä¸‹é™
- å·¥ç¨‹è¨­è¨ˆé‡é»åœ¨ã€Œç³»çµ±ã€ï¼Œä¸æ˜¯å–®ä¸€æ•¸å€¼
""")

# =================================================
# å·¥ç¨‹æ±ºç­–åæ€
# =================================================
st.subheader("ä¸‰ã€å·¥ç¨‹æ±ºç­–åæ€")

st.info("""
æ€è€ƒå•é¡Œï¼š
1. ä½ æœƒå„ªå…ˆé™ä½å“ªä¸€å€‹å…ƒä»¶çš„å¤±æ•ˆæ©Ÿç‡ï¼Ÿ
2. æ˜¯é™ä½å¹³å‡å€¼é‡è¦ï¼Œé‚„æ˜¯é™ä½è®Šç•°é‡è¦ï¼Ÿ
3. ç‚ºä»€éº¼å·¥ç¨‹è¦ç¯„å¸¸è¦æ±‚ã€Œå¤šé‡é˜²è­·ã€ï¼Ÿ
""")
